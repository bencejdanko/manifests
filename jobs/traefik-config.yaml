apiVersion: helm.cattle.io/v1
kind: HelmChartConfig
metadata:
  name: traefik
  namespace: kube-system
spec:
  valuesContent: |
    metrics:
      prometheus:
        enabled: true

    ports:
      metrics:
        port: 9100
        expose:
          default: false
        protocol: TCP

    serviceMonitor:
      create: true
      namespace: monitoring
      additionalLabels:
        release: kube-prometheus-stack

    # --- LOGS: enable OpenTelemetry (experimental in Traefik) ---
    experimental:
      otlpLogs: true

    # Traefik process logs -> OTLP over HTTP to collector
    log:
      format: json
      otlp:
        http:
          endpoint: http://otel-collector.monitoring.svc.cluster.local:4318/v1/logs

    # Traefik access logs -> OTLP over HTTP to collector
    accesslog:
      format: json
      otlp:
        http:
          endpoint: http://otel-collector.monitoring.svc.cluster.local:4318/v1/logs
